**otus**

**otus** 

# **Топология**
![This topology has two PCs, a router R1 and a switch S1. PC-A is connected to switch S1 F0/6. Switch S1 F0/5 is connected to R1  G0/0/1. Router R1 g0/0/0 is connected to PC-B.](Aspose.Words.710adf75-3a0f-4fd5-b055-dc827b24eb92.001.png)
# **Таблица адресации**

|**Устройство**|**Интерфейс**|**IPv6-адрес**|**Длина префикса**|**Шлюз по умолчанию**|
| :-: | :-: | :-: | :-: | :-: |
|R1|G0/0/0|2001:db8:acad:a::1|64|—|
|*R1*|G0/0/1|2001:db8:acad:1::1 |64|—|
|S1|VLAN 1|2001:db8:acad:1::b|64|—|
|PC-A|NIC|2001:db8:acad:1::3|64|fe80::1|
|PC-B|NIC|2001:db8:acad:a::3|64|fe80::1|
# **Задачи**
**Часть 1. Настройка топологии и конфигурация основных параметров маршрутизатора и коммутатора**

**Часть 2. Ручная настройка IPv6-адресов**

**Часть 3. Проверка сквозного соединения**

**Примечание**:  Убедитесь, что у всех маршрутизаторов и коммутаторов была удалена начальная конфигурация. Если вы не уверены, обратитесь к инструктору.

Примечание. Шаблон по умолчанию менеджера базы данных 2960 Switch Database Manager (SDM) не поддерживает IPv6. Перед назначением IPv6-адреса SVI VLAN 1 может понадобиться выполнение команды** sdm prefer dual-ipv4-and-ipv6 default **для включения IPv6-адресации.**

Примечание. **Шаблон default bias**, который по умолчанию используется диспетчером SDM (диспетчер базы данных коммутатора), не предоставляет возможностей адресации IPv6. Убедитесь, что SDM использует шаблон dual-ipv4-and-ipv6 или **lanbase-routing.** Новый шаблон будет использоваться после перезагрузки. 

S1# **show sdm prefer**

Чтобы установить шаблон dual-ipv4-and-ipv6 в качестве шаблона SDM по умолчанию, выполните следующие действия:

S1# **configure terminal**

S1(config)# **sdm prefer dual-ipv4-and-ipv6 default**

S1(config)# **end**

S1# **reload**
# **Необходимые ресурсы**
- 1 Маршрутизатор (Cisco 4221 с универсальным образом Cisco IOS XE версии 16.9.4 или аналогичным)
- 1 коммутатор (Cisco 2960 с ПО Cisco IOS версии 15.2(2) с образом lanbasek9 или аналогичная модель)
- 2 ПК (Windows и программа эмуляции терминала, такая как Tera Term)
- Консольные кабели для настройки устройств Cisco IOS через консольные порты.
- Кабели Ethernet, расположенные в соответствии с топологией

Примечание**. Интерфейсы Gigabit Ethernet на маршрутизаторах Cisco 4221 определяют скорость автоматически, поэтому для подключения маршрутизатора к PC-B можно использовать прямой кабель Ethernet. При использовании другой модели маршрутизатора Cisco может возникнуть необходимость использовать перекрестный кабель Ethernet.**
# **Инструкции**
1. ## **Настройка топологии и конфигурация основных параметров маршрутизатора и коммутатора**
   1. ### **Настройте маршрутизатор.**
      Назначил имя хоста и настройте основные параметры устройства.
   1. ### **Настройте коммутатор.**
Назначил имя хоста и настройте основные параметры устройства.
1. ## **Ручная настройка IPv6-адресов**
   1. ### **Назначьте IPv6-адреса интерфейсам Ethernet на R1.**
      1. Назначьте глобальные индивидуальные IPv6-адреса, указанные в таблице адресации обоим интерфейсам Ethernet на R1.

         R1(config-if)#ipv6 address 2001:db8:acad:a::1/64

         R1(config-if)#ipv6 address 2001:db8:acad:1::1/64

*Откройте окно конфигурации*

1. Введите команду show ipv6 interface brief, чтобы проверить, назначен ли каждому интерфейсу корректный индивидуальный IPv6-адрес.

   R1#show ipv6 interface brief

   GigabitEthernet0/0/0       [up/up]

   `    `FE80::230:F2FF:FEDE:7701

   `    `2001:DB8:ACAD:A::1

   GigabitEthernet0/0/1       [up/up]

   `    `FE80::230:F2FF:FEDE:7702

   `    `2001:DB8:ACAD:1::1

Примечание**. Отображаемый локальный адрес канала основан на адресации EUI-64, которая автоматически использует MAC-адрес интерфейса для создания 128-битного локального IPv6-адреса канала.**

1. Чтобы обеспечить соответствие локальных адресов канала индивидуальному адресу, вручную введите локальные адреса канала на каждом интерфейсе Ethernet на R1.

   R1(config)#interface g0/0/0

   R1(config-if)#ipv6 address FE80::1 link-local

   R1(config-if)#no shutdown 

   R1(config-if)#interface g0/0/1

   R1(config-if)#ipv6 address FE80::1 link-local

   R1(config-if)#no shutdown

1. Используйте выбранную команду, чтобы убедиться, что локальный адрес связи изменен на fe80::1.

R1#show ipv6 interface brief

GigabitEthernet0/0/0 [up/up]

FE80::1

2001:DB8:ACAD:A::1

GigabitEthernet0/0/1 [up/up]

FE80::1

2001:DB8:ACAD:1::1

*кройте окно настройки.Вопрос:*

Какие группы многоадресной рассылки назначены интерфейсу G0/0/0?

Назанчена только 1 группа FF02::1

R2#show ipv6 interface gigabitEthernet 0/0/0

GigabitEthernet0/0/0 is administratively down, line protocol is down

IPv6 is tentative, link-local address is FE80::1 [TEN]

No Virtual link-local address(es):

Global unicast address(es):

2001:DB8:ACAD:A::1, subnet is 2001:DB8:ACAD:A::/64 [TEN]

Joined group address(es):

FF02::1

MTU is 1500 bytes

ICMP error messages limited to one every 100 milliseconds

ICMP redirects are enabled

ICMP unreachables are sent

ND DAD is enabled, number of DAD attempts: 1

ND reachable time is 30000 milliseconds

R2#

R2#

R2#

R2#show ipv6 interface gigabitEthernet 0/0/1

GigabitEthernet0/0/1 is administratively down, line protocol is down

IPv6 is tentative, link-local address is FE80::1 [TEN]

No Virtual link-local address(es):

Global unicast address(es):

2001:DB8:ACAD:1::1, subnet is 2001:DB8:ACAD:1::/64 [TEN]

Joined group address(es):

FF02::1


1. ### ` `**Активируйте IPv6-маршрутизацию на R1.**
   1. В командной строке на PC-B введите команду **ipconfig**, чтобы получить данные IPv6-адреса, назначенного интерфейсу ПК.
      #### Вопрос:
      Назначен ли индивидуальный IPv6-адрес сетевой интерфейсной карте (NIC) на PC-B?

      Нет.

IPv6 Address....................: ::

1. Активировал IPv6-маршрутизацию на R1 с помощью команды **IPv6 unicast-routing**.

*, чтобы убедиться, что новая многоадресная группа назначена интерфейсу G0/0/0. Обратите внимание, что в списке групп для интерфейса G0/0 отображается группа многоадресной рассылки всех маршрутизаторов (FF02::2).*

**Примечание**. Это позволит компьютерам получать IP-адреса и данные шлюза по умолчанию с помощью функции SLAAC (Stateless Address Autoconfiguration (Автоконфигурация без сохранения состояния адреса)).

1. Теперь, когда R1 входит в группу многоадресной рассылки всех маршрутизаторов, еще раз введите команду **ipconfig** на PC-B. Проверьте данные IPv6-адреса.

C:\>ipconfig

FastEthernet0 Connection:(default port)

Connection-specific DNS Suffix..: 

Link-local IPv6 Address.........: FE80::2E0:8FFF:FE9B:97E5

IPv6 Address....................: 2001:DB8:ACAD:1:2E0:8FFF:FE9B:97E5

IPv4 Address....................: 0.0.0.0

Subnet Mask.....................: 0.0.0.0

Default Gateway.................: FE80::1

0\.0.0.0
#### Вопрос:
Почему PC-B получил глобальный префикс маршрутизации и идентификатор подсети, которые вы настроили на R1?

При включении **IPv6 unicast-routing** (SLAAC) R1 и хост начинают обмениваться RS и RA сообщениями с данными для автоконфигурирования
1. ### **Назначьте IPv6-адреса интерфейсу управления (SVI) на S1.**
   1. Назначьте адрес IPv6 для S1. Также назначьте этому интерфейсу локальный адрес канала.

S1(config)#int vlan 1

S1(config-if)#ipv6 addr 2001:db8:acad:1::b/64

S1(config-if)#ipv6 addr fe80::2 link-local

S1(config-if)#no shutdown

1. Проверьте правильность назначения IPv6-адресов интерфейсу управления с помощью команды show ipv6 interface vlan1.

S1#show ipv6 interface vlan 1

Vlan1 is up, line protocol is up

IPv6 is enabled, link-local address is FE80::2

No Virtual link-local address(es):

Global unicast address(es):

2001:DB8:ACAD:1::B, subnet is 2001:DB8:ACAD:1::/64

*Закройте окно настройки.*
1. ### **Назначьте компьютерам статические IPv6-адреса.**
   1. Откройте окно Свойства Ethernet для каждого ПК и назначьте адресацию IPv6.

      PC-A

      ![](Aspose.Words.710adf75-3a0f-4fd5-b055-dc827b24eb92.002.png)

      ![](Aspose.Words.710adf75-3a0f-4fd5-b055-dc827b24eb92.003.png)

      PC-B

      ![](Aspose.Words.710adf75-3a0f-4fd5-b055-dc827b24eb92.004.png)

      ![](Aspose.Words.710adf75-3a0f-4fd5-b055-dc827b24eb92.005.png)

   1. Убедитесь, что оба компьютера имеют правильную информацию адреса IPv6. Каждый компьютер должен иметь два глобальных адреса IPv6: один статический и один SLAAC
1. ## **Проверка сквозного подключения**
С PC-A отправьте эхо-запрос на **FE80::1**. Это локальный адрес канала, назначенный G0/1 на R1.

C:\>ping fe80::1

Pinging fe80::1 with 32 bytes of data:

Reply from FE80::1: bytes=32 time<1ms TTL=255

Reply from FE80::1: bytes=32 time<1ms TTL=255

Reply from FE80::1: bytes=32 time<1ms TTL=255

Reply from FE80::1: bytes=32 time<1ms TTL=255

Ping statistics for FE80::1:

Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),

Approximate round trip times in milli-seconds:

Minimum = 0ms, Maximum = 0ms, Average = 0ms

Отправьте эхо-запрос на интерфейс управления S1 с PC-A.

C:\>ping 2001:db8:acad:1::b

Pinging 2001:db8:acad:1::b with 32 bytes of data:

Reply from 2001:DB8:ACAD:1::B: bytes=32 time=2019ms TTL=255

Reply from 2001:DB8:ACAD:1::B: bytes=32 time<1ms TTL=255

Reply from 2001:DB8:ACAD:1::B: bytes=32 time<1ms TTL=255

Reply from 2001:DB8:ACAD:1::B: bytes=32 time<1ms TTL=255

Ping statistics for 2001:DB8:ACAD:1::B:

Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),

Approximate round trip times in milli-seconds:

Minimum = 0ms, Maximum = 2019ms, Average = 504ms

Введите команду **tracert** на PC-A, чтобы проверить наличие сквозного подключения к PC-B.

С PC-B отправьте эхо-запрос на PC-A.

\>tracert 2001:db8:acad:a::3

Tracing route to 2001:db8:acad:a::3 over a maximum of 30 hops: 

1 0 ms 0 ms 0 ms 2001:DB8:ACAD:1::1

2 0 ms 0 ms 0 ms 2001:DB8:ACAD:A::3

Trace complete.

С PC-B отправьте эхо-запрос на локальный адрес канала G0/0 на R1.

\>ping 2001:db8:acad:a::1

Pinging 2001:db8:acad:a::1 with 32 bytes of data:

Reply from 2001:DB8:ACAD:A::1: bytes=32 time<1ms TTL=255

Reply from 2001:DB8:ACAD:A::1: bytes=32 time<1ms TTL=255

Reply from 2001:DB8:ACAD:A::1: bytes=32 time<1ms TTL=255

Reply from 2001:DB8:ACAD:A::1: bytes=32 time<1ms TTL=255

Ping statistics for 2001:DB8:ACAD:A::1:

Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),

Approximate round trip times in milli-seconds:

Minimum = 0ms, Maximum = 0ms, Average = 0ms

**Примечание.**  В случае отсутствия сквозного подключения проверьте, правильно ли указаны IPv6-адреса на всех устройствах.
# **Вопросы для повторения**
1. Почему обоим интерфейсам Ethernet на R1 можно назначить один и тот же локальный адрес канала — FE80::1?

Каждый из интерфейсов подключен к отдельной локальной сети со своими пулами адресов.

1. Какой идентификатор подсети в индивидуальном IPv6-адресе 2001:db8:acad::aaaa:1234/64?

   2001:db8:acad:0000:0000:0000:aaaa:1234/64?

0000
© ã 2013 г. - гггг Корпорация Cisco и/или ее дочерние компании. Все права защищены. Открытая информация Cisco 	страница 2** 4**	www.netacad.com
